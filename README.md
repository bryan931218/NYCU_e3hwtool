# E3 作業追蹤器（Web）

👉 https://e3hwtool.space

幫助 NYCU 學生統整 E3 平台上的所有作業。只要貼上自己的 MoodleSession，系統就會列出所有課程作業、狀態、截止日期，還能導出 Excel 或同步到 Google 日曆。

> **注意**：僅供學習用途，請勿濫用；請確保遵守學校與 E3 系統的使用規範。

---

## 功能一覽

| 功能                           | 說明                                                                                  |
| ------------------------------ | ------------------------------------------------------------------------------------- |
| 作業蒐集                       | 會將所有課程作業抓成列表，並顯示逾期 / 已完成標記。                                   |
| 視圖切換                       | Web 介面提供「依課程」與「依截止日」兩種視圖，可用複選框篩選條件。                    |
| Excel 導出                     | 一鍵輸出 `pending_assignments.xlsx`，可供自行整理或分享。                             |
| Google 日曆同步                | 以桃紅色事件、兩天前提醒的方式加入 Google Calendar，且可在彈窗中勾選要同步的作業。     |
| 緩存與背景更新                 | 登入後會快取作業結果，背景定時刷新並提示使用者。                                      |
| 多人協作                       | 每個使用者登入後有獨立快取與設定，可分享給同學共同使用。                              |

---

## 操作流程

1. **登入網站**  
   - 進入 https://www.e3hwtool.space  
   - 初次登入可輸入 E3 帳密，或貼入 `MoodleSession` cookie。  
   - 管理者亦可設定預設帳號（`.env` 內的 `E3_USERNAME/E3_PASSWORD`）。

2. **檢視作業**  
   - 預設顯示依課程排序，可改為「到期日排序」。  
   - 勾選「顯示逾期作業」、「顯示已完成作業」便可即時篩選。  
   - 每筆作業都會列出狀態與直接連結。

3. **導出 Excel**  
   - 工具列按下「導出作業資訊」，會下載 `pending_assignments.xlsx`。  
   - Excel 內容會依目前篩選條件整理，方便另存或分享。

4. **導入 Google 日曆**  
   - 在工具列點「導入至 Google 日曆」。  
   - 第一次需要完成 OAuth 授權，之後再按此按鈕會跳出一個彈窗。  
   - 彈窗會列出「目前視圖與篩選條件下」所有有截止日的作業，可任意勾選後按「導入」。  
   - 導入過程會顯示進度動畫；導入完成後會有 Toast 通知。
   - 每個事件會帶 `[作業]` 標籤、桃紅色（Google Calendar colorId 4）、並設定兩天前提醒。

5. **背景更新 / 快取**  
   - 系統會將最新結果儲存在伺服器暫存資料夾（僅限登入者自己可見）。  
   - 若背景更新成功，介面右下角會提示「已成功更新」；失敗時也會顯示錯誤訊息。

---

## 介面截圖

> 請將實際截圖放在 `docs/images` 後再更新以下路徑。

1. **登入頁**  
   ![登入頁](docs/images/login.png)

2. **作業總覽（課程視圖）**  
   ![作業總覽](docs/images/dashboard.png)

3. **Google 日曆導入彈窗**  
   ![Google Day Modal](docs/images/google-modal.png)

---

## 安全與隱私建議

- **使用 Cookie**：如果不想輸入密碼，可在瀏覽器登入 E3 後，從開發者工具複製 `MoodleSession` 貼到網頁即可。
- **HTTPS**：整站使用 AWS ACM 憑證，請務必透過 `https://www.e3hwtool.space` 連線。
- **OAuth 限制**：NYCU OAuth 只能取得基本身分，無法自動產生 MoodleSession，因此仍需使用 Cookie 來抓作業。未來若學校提供正式 API，再改為純 OAuth。

---

## 常見問題

| 問題                                             | 解法                                                                                                  |
| ------------------------------------------------ | ----------------------------------------------------------------------------------------------------- |
| 瀏覽器顯示「連線不安全」                        | 請確認使用的是 `https://www.e3hwtool.space`，若瀏覽器緩存舊憑證請清除快取或使用無痕模式再試。          |
| Google 授權後沒有任何反應                        | 確認 Google Console 與 `.env` 的 `E3_GOOGLE_REDIRECT_URI` 一致，且 `/tmp/e3_tracker_cache` 有產生 token |
| 彈窗沒有作業可勾選                              | 目前視圖沒有「尚有截止時間」的作業，請放寬篩選或切換視圖。                                             |
| 需要重新登入                                     | 如果快取過期或 `MoodleSession` 失效，系統會提示重新登入；貼上新的 Cookie 即可。                         |

---

## 聯絡 / 貢獻

- 若有建議或功能需求，歡迎開 Issue 或 Pull Request。
- 任何與隱私、安全相關的疑慮，也可透過 GitHub Issue 私訊討論。

---

## 網站連結

👉 **https://www.e3hwtool.space**
